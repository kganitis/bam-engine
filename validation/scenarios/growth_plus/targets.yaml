# ==============================================================================
# BAM Growth+ Scenario Validation Targets
# ==============================================================================
#
# Target metrics derived from Delli Gatti et al. (2011), Section 3.9.2
# "Macroeconomics from the Bottom-up" Growth+ extension scenario results.
#
# Structure:
#   metadata: Scenario configuration and R&D parameters
#   metrics: Validation targets with standardized keys
#     - MEAN_TOLERANCE checks: 'target', 'tolerance'
#     - RANGE checks: 'min', 'max'
#     - PCT_WITHIN checks: 'target', 'min'
#     - BOOLEAN checks: 'threshold'
#     - OUTLIER checks: 'max_outlier', 'penalty_weight'
#
# ==============================================================================

metadata:
  source: "Delli Gatti et al. (2011), Section 3.9.2"
  description: "Growth+ scenario - Endogenous Productivity Growth via R&D"

  validation:
    burn_in_periods: 500

  # R&D extension parameters
  extension_params:
    sigma_min: 0.0
    sigma_max: 0.1
    sigma_decay: -1.0

  # Parameters needed by compute_metrics
  params:
    firm_size_threshold: 150.0
    firm_size_threshold_medium: 100.0

  # Visualization-specific target structure (used by growth_plus_viz.py)
  visualization:
    time_series:
      unemployment_rate:
        targets:
          normal_min: 0.02
          normal_max: 0.15
          extreme_min: 0.00
          extreme_max: 0.30
          mean_target: 0.055
          std_min: 0.02
          std_max: 0.05

      inflation_rate:
        targets:
          normal_min: -0.02
          normal_max: 0.10
          extreme_min: -0.06
          extreme_max: 0.15
          mean_target: 0.04

      log_gdp:
        targets:
          normal_min: 8.6
          normal_max: 9.3
          extreme_min: 8.4
          extreme_max: 9.4
          mean_target: 8.95

      productivity:
        targets:
          initial_min: 8
          initial_max: 12
          final_min: 18
          final_max: 25
          total_growth_min: 0.8
          total_growth_max: 2.5
          trend_coefficient_min: 0.001
          trend_coefficient_max: 0.004

      real_wage:
        targets:
          initial_min: 5
          initial_max: 8
          final_min: 12
          final_max: 18
          total_growth_min: 0.8
          total_growth_max: 2.5

    curves:
      phillips:
        targets:
          correlation_target: -0.19
          correlation_min: -0.35
          correlation_max: -0.05

      okun:
        targets:
          correlation_target: -0.85
          correlation_min: -0.98
          correlation_max: -0.70

      beveridge:
        targets:
          correlation_target: -0.27
          correlation_min: -0.50
          correlation_max: -0.10

    distributions:
      firm_size:
        targets:
          threshold_small: 150.0
          threshold_medium: 100.0
          pct_below_small_target: 0.90
          pct_below_small_min: 0.80
          pct_below_small_max: 0.95
          pct_below_medium_target: 0.45
          pct_below_medium_min: 0.35
          skewness_target: 3.0
          skewness_tolerance: 2.5
          skewness_hard_min: 0.50
          skewness_hard_max: 10.0
          tail_ratio_min: 2.0
          tail_ratio_max: 10.0

      vacancy_rate:
        targets:
          normal_min: 0.08
          normal_max: 0.18
          mean_target: 0.12

    financial_dynamics:
      bankruptcies:
        targets:
          mean_target: 3.0
          mean_tolerance: 2.5

      real_interest_rate:
        targets:
          mean_target: 0.05
          mean_tolerance: 0.02
          std_target: 0.02
          std_tolerance: 0.01
          normal_min: -0.02
          normal_max: 0.12
          extreme_min: -0.05
          extreme_max: 0.15

      financial_fragility:
        targets:
          mean_target: 0.08
          mean_tolerance: 0.03
          cv_target: 0.15
          cv_tolerance: 0.08
          normal_min: 0.05
          normal_max: 0.12
          extreme_min: 0.02
          extreme_max: 0.15

      price_ratio:
        targets:
          mean_target: 1.35
          mean_tolerance: 0.15
          cv_target: 0.15
          cv_tolerance: 0.08
          normal_min: 1.1
          normal_max: 1.8
          extreme_min: 1.0
          extreme_max: 2.0

      price_dispersion:
        targets:
          mean_target: 0.28
          mean_tolerance: 0.12
          cv_target: 0.40
          cv_tolerance: 0.15
          normal_min: 0.20
          normal_max: 0.35
          extreme_min: 0.15
          extreme_max: 0.40

      equity_dispersion:
        targets:
          mean_target: 1.5
          mean_tolerance: 0.5
          cv_target: 0.28
          cv_tolerance: 0.12
          normal_min: 0.6
          normal_max: 2.5
          extreme_min: 0.3
          extreme_max: 3.0

      sales_dispersion:
        targets:
          mean_target: 1.5
          mean_tolerance: 0.5
          cv_target: 0.35
          cv_tolerance: 0.15
          normal_min: 0.5
          normal_max: 3.0
          extreme_min: 0.3
          extreme_max: 3.5

      minsky_classification:
        targets:
          hedge_pct_target: 0.67
          hedge_pct_min: 0.40
          hedge_pct_max: 0.85
          ponzi_pct_target: 0.10
          ponzi_pct_min: 0.02
          ponzi_pct_max: 0.50

      output_growth_distribution:
        targets:
          tight_range_min: -0.05
          tight_range_max: 0.05
          normal_range_min: -0.10
          normal_range_max: 0.10
          extreme_range_min: -0.15
          extreme_range_max: 0.15
          pct_within_tight_target: 0.95
          pct_within_tight_min: 0.90
          pct_within_normal_target: 0.99
          pct_within_normal_min: 0.96
          max_outlier_pct: 0.02
          outlier_penalty_weight: 2.0

      networth_growth_distribution:
        targets:
          tight_range_min: -0.05
          tight_range_max: 0.05
          normal_range_min: -0.10
          normal_range_max: 0.10
          extreme_range_min: -0.50
          extreme_range_max: 0.20
          pct_within_tight_target: 0.75
          pct_within_tight_min: 0.60
          pct_within_normal_target: 0.90
          pct_within_normal_min: 0.80
          max_outlier_pct: 0.05
          outlier_penalty_weight: 2.0
          tent_r2_min: 0.65


# ==============================================================================
# Metric Targets (standardized keys)
# ==============================================================================

metrics:

  # --------------------------------------------------------------------------
  # Time Series Metrics
  # --------------------------------------------------------------------------

  unemployment_rate_mean:
    target: 0.055
    tolerance: 0.025

  unemployment_hard_ceiling:
    threshold: 0.30  # For reference (BOOLEAN uses MetricSpec threshold)

  unemployment_std:
    min: 0.02
    max: 0.05

  unemployment_pct_in_bounds:
    target: 0.95
    min: 0.90

  inflation_rate_mean:
    target: 0.04
    tolerance: 0.025

  inflation_hard_ceiling_upper:
    threshold: 0.25

  inflation_hard_floor:
    threshold: -0.15

  inflation_non_degenerate:
    min: 0.0
    max: 0.10

  inflation_pct_in_bounds:
    target: 0.90
    min: 0.80

  log_gdp_mean:
    target: 8.95
    tolerance: 0.15

  log_gdp_trend:
    min: 0.001
    max: 0.003

  log_gdp_trend_positive:
    # BOOLEAN check - must be > 0
    threshold: 0.0

  log_gdp_total_growth:
    min: 0.5
    max: 1.2

  vacancy_rate_mean:
    target: 0.12
    tolerance: 0.03

  vacancy_rate_pct_in_bounds:
    target: 0.90
    min: 0.80

  # --------------------------------------------------------------------------
  # Curve Correlations
  # --------------------------------------------------------------------------

  phillips_correlation:
    min: -0.50  # Extended from -0.35 to allow stronger correlations
    max: -0.05

  phillips_negative_sign:
    min: -1.0
    max: 0.0

  okun_correlation:
    min: -0.98
    max: -0.70
    # Tiered thresholds:
    # - PASS: r in [-0.98, -0.70]
    # - WARN: r in [-0.70, -0.56] (symmetric buffer)
    # - FAIL: r > -0.56 (from RANGE) or r >= -0.50 (from okun_weak_fail)

  okun_weak_fail:
    threshold: -0.50  # For reference (BOOLEAN uses MetricSpec threshold)

  beveridge_correlation:
    min: -0.50
    max: -0.10

  beveridge_negative_sign:
    min: -1.0
    max: 0.0

  # --------------------------------------------------------------------------
  # Distribution Metrics
  # --------------------------------------------------------------------------

  firm_size_skewness:
    target: 3.0       # Moderate right-skewness
    tolerance: 2.0    # PASS: [1.0, 5.0] with gradual score decay
    min: 1.0          # FAIL below this
    max: 10.0         # FAIL above this; anything in [1.0, 10.0] is at most WARN

  firm_size_pct_below:
    min: 0.85
    max: 0.95

  firm_size_tail_ratio:
    min: 2.0
    max: 10.0

  firm_size_pct_below_medium:
    target: 0.45
    min: 0.35

  # --------------------------------------------------------------------------
  # Growth Metrics
  # --------------------------------------------------------------------------

  productivity_growth:
    min: 0.8
    max: 2.5

  real_wage_growth:
    min: 0.8
    max: 2.5

  # Productivity-Wage Co-movement (Figure 3.4d validation)
  productivity_wage_correlation:
    min: 0.5   # CRITICAL: must show strong cyclical alignment
    max: 1.0

  wage_productivity_ratio_mean:
    target: 0.675  # Wage ~60-75% of productivity (book shows ~65%)
    tolerance: 0.075

  wage_productivity_ratio_std:
    min: 0.0
    max: 0.10  # Stable ratio indicates parallel movement

  productivity_trend:
    min: 0.001
    max: 0.004

  n_recessions:
    min: 2
    max: 8

  avg_recession_length:
    min: 20
    max: 100

  # --------------------------------------------------------------------------
  # Financial Dynamics Metrics
  # --------------------------------------------------------------------------

  bankruptcies_mean:
    target: 2.0
    tolerance: 1.5

  real_interest_rate_mean:
    target: 0.05
    tolerance: 0.02

  real_interest_rate_std:
    target: 0.02
    tolerance: 0.01

  real_interest_rate_pct_in_bounds:
    target: 0.80
    min: 0.70

  financial_fragility_mean:
    target: 0.08
    tolerance: 0.03

  financial_fragility_cv:
    target: 0.15
    tolerance: 0.08

  fragility_gdp_correlation:
    min: 0.0
    max: 1.0

  price_ratio_mean:
    target: 1.35
    tolerance: 0.15

  price_ratio_cv:
    target: 0.15
    tolerance: 0.08

  price_ratio_gdp_correlation:
    min: -0.95
    max: -0.40

  price_ratio_floor:
    threshold: 1.0

  price_ratio_low_end:
    min: 1.05
    max: 1.55

  price_dispersion_mean:
    target: 0.28
    tolerance: 0.12

  price_dispersion_cv:
    target: 0.40
    tolerance: 0.15

  price_dispersion_gdp_correlation:
    min: 0.0
    max: 1.0

  equity_dispersion_mean:
    target: 1.5
    tolerance: 0.5

  equity_dispersion_cv:
    target: 0.28
    tolerance: 0.12

  equity_dispersion_gdp_correlation:
    min: 0.0
    max: 1.0

  sales_dispersion_mean:
    target: 1.5
    tolerance: 0.5

  sales_dispersion_cv:
    target: 0.35
    tolerance: 0.15

  sales_dispersion_gdp_correlation:
    min: 0.0
    max: 1.0

  # --------------------------------------------------------------------------
  # Minsky Classification
  # --------------------------------------------------------------------------

  minsky_hedge_pct:
    min: 0.40
    max: 0.85

  minsky_ponzi_pct:
    min: 0.02
    max: 0.50

  # --------------------------------------------------------------------------
  # Growth Rate Distribution Metrics
  # --------------------------------------------------------------------------

  output_growth_pct_tight:
    target: 0.95
    min: 0.90

  output_growth_pct_normal:
    target: 0.99
    min: 0.96

  output_growth_outliers:
    max_outlier: 0.02
    penalty_weight: 2.0

  output_growth_tent_r2:
    min: 0.85
    max: 1.0

  output_growth_positive_frac:
    min: 0.50
    max: 0.85

  networth_growth_pct_tight:
    target: 0.75
    min: 0.60

  networth_growth_pct_normal:
    target: 0.90
    min: 0.80

  networth_growth_outliers:
    max_outlier: 0.05
    penalty_weight: 2.0

  networth_growth_tent_r2:
    min: 0.65
    max: 1.0
